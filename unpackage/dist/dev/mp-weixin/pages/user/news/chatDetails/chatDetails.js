(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/news/chatDetails/chatDetails"],{205:function(e,n,t){"use strict";(function(e,n){var s=t(4);t(26);s(t(25));var o=s(t(206));e.__webpack_require_UNI_MP_PLUGIN__=t,n(o.default)}).call(this,t(1)["default"],t(2)["createPage"])},206:function(e,n,t){"use strict";t.r(n);var s=t(207),o=t(209);for(var c in o)["default"].indexOf(c)<0&&function(e){t.d(n,e,(function(){return o[e]}))}(c);t(211);var a,r=t(32),i=Object(r["default"])(o["default"],s["render"],s["staticRenderFns"],!1,null,null,null,!1,s["components"],a);i.options.__file="pages/user/news/chatDetails/chatDetails.vue",n["default"]=i.exports},207:function(e,n,t){"use strict";t.r(n);var s=t(208);t.d(n,"render",(function(){return s["render"]})),t.d(n,"staticRenderFns",(function(){return s["staticRenderFns"]})),t.d(n,"recyclableRender",(function(){return s["recyclableRender"]})),t.d(n,"components",(function(){return s["components"]}))},208:function(e,n,t){"use strict";var s;t.r(n),t.d(n,"render",(function(){return o})),t.d(n,"staticRenderFns",(function(){return a})),t.d(n,"recyclableRender",(function(){return c})),t.d(n,"components",(function(){return s}));try{s={uniIcons:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uni-icons/components/uni-icons/uni-icons")]).then(t.bind(null,259))}}}catch(r){if(-1===r.message.indexOf("Cannot find module")||-1===r.message.indexOf(".vue"))throw r;console.error(r.message),console.error("1. 排查组件名称拼写是否正确"),console.error("2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom"),console.error("3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件")}var o=function(){var e=this,n=e.$createElement,t=(e._self._c,e.messages.length);e.$mp.data=Object.assign({},{$root:{g0:t}})},c=!1,a=[];o._withStripped=!0},209:function(e,n,t){"use strict";t.r(n);var s=t(210),o=t.n(s);for(var c in s)["default"].indexOf(c)<0&&function(e){t.d(n,e,(function(){return s[e]}))}(c);n["default"]=o.a},210:function(e,n,t){"use strict";(function(e){var s=t(4);Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var o=s(t(50)),c=s(t(52)),a=s(t(53)),r={data:function(){return{img:"",img2:"",tousername:"",username:"",textMessage:"",socketTask:null,socketOpen:!1,socketOpening:!1,socketMsgQueue:[],messages:[{message:"",username:"",tousername:""}],send:!1}},onLoad:function(e){console.log(e),this.tousername=e.tousername,this.username=e.username,console.log(this.username+"user"),console.log(this.tousername+"touser")},onShow:function(){console.log("onshow"),this.socketOpening||this.socketOpen||this.connectSocketInit()},onUnload:function(){console.log("onUnload"),this.closeSocket()},methods:{changeSend:function(){this.textMessage?this.send=!0:this.send=!1},closeSocket:function(){console.log("调用成功");var e=this;this.socketTask.close({success:function(n){e.socketOpen=!1,console.log("关闭成功",n)},fail:function(e){console.log("关闭失败",e)}})},clickRequest:function(){var e=this;if(this.socketOpen){var n={message:this.textMessage,username:this.username,to:this.tousername};console.log(n),this.socketTask.send({data:JSON.stringify(n),success:function(){return(0,c.default)(o.default.mark((function e(){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("消息发送成功");case 1:case"end":return e.stop()}}),e)})))()}}),this.socketTask.onMessage((function(n){"c"==n.data.charAt(3)&&(e.messages=JSON.parse(n.data)),console.log(n.data),console.log(n.data.charAt(3))}))}else socketMsgQueue.push(this.message)},connectSocketInit:function(){var n=this;this.socketOpening=!0,this.socketTask=e.connectSocket({url:a.default.WebSocket+"/websocket/".concat(this.username,"/").concat(this.tousername),success:function(){console.log("this.socketTask = uni.connectSocket success")}}),this.socketTask.onOpen((function(e){console.log("WebSocket连接正常打开中...！"),n.socketOpen=!0,n.socketOpening=!1,n.socketTask.send({data:"发送一条消息",success:function(){return(0,c.default)(o.default.mark((function e(){return o.default.wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log("消息发送成功");case 1:case"end":return e.stop()}}),e)})))()}})})),this.socketTask.onMessage((function(e){if("o"==e.data.charAt(3)){var t=JSON.parse(e.data);n.messages=t.data.messages,console.log("888888"),console.log(n.messages);var s=t.data.hashmap;console.log("999999");var o=n.username,c=n.tousername;n.img="http://106.54.177.78:9112/"+s[o],n.img2="http://106.54.177.78:9112/"+s[c]}console.log(e.data.charAt(3))})),this.socketTask.onClose((function(){console.log("已经被关闭了")}))}}};n.default=r}).call(this,t(2)["default"])},211:function(e,n,t){"use strict";t.r(n);var s=t(212),o=t.n(s);for(var c in s)["default"].indexOf(c)<0&&function(e){t.d(n,e,(function(){return s[e]}))}(c);n["default"]=o.a},212:function(e,n,t){}},[[205,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../../../.sourcemap/mp-weixin/pages/user/news/chatDetails/chatDetails.js.map